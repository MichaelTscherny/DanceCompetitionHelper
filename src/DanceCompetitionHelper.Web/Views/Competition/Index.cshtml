@using DanceCompetitionHelper.Database.Tables;
@using DanceCompetitionHelper.Web.Controllers;

@model IEnumerable<Competition>

@{
    ViewData["Title"] = "Competitions";
}

<div class="text-center">
    <h1 class="display-6">Available Competitions</h1>
    
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.CompetitionDate)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Organization)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.CompetitionName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.CompetitionInfo)
                </th>
                <th>
                    Competition Classes
                </th>
                <th>
                    Participants
                </th>
                <th>
                    Multiple Starters
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        <!-- what to use?.. @Html.DisplayFor(modelItem => item.CompetitionDate) -->
                        @item.CompetitionDate.ToShortDateString()
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Organization)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.CompetitionName)&nbsp;
                        (@Html.DisplayFor(modelItem => item.OrgCompetitionId))
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.CompetitionInfo)
                    </td>
                    <td>
                        @(item.DisplayInfo?.CountCompetitionClasses ?? -1)
                    </td>
                    <td>
                        @(item.DisplayInfo?.CountParticipants ?? -1)
                    </td>
                    <td>
                        @(item.DisplayInfo?.CountMultipleStarters ?? -1)
                    </td>
                    <td>
                        <a asp-controller="@CompetitionController.RefName"
                           asp-action="@nameof(CompetitionController.ShowEdit)" 
                           asp-route-id="@item.CompetitionId">Edit</a> |
                        <a asp-controller="@CompetitionClassController.RefName"
                           asp-action="@nameof(CompetitionClassController.Index)"
                           asp-route-id="@item.CompetitionId">Details</a> |
                        <a asp-controller="@CompetitionController.RefName"
                           asp-action="@nameof(CompetitionController.Delete)"
                           asp-route-id="@item.CompetitionId">Delete</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <hr />
    <div class="row d-flex justify-content-center py-1">
        <div class="col">
            <a asp-action="@nameof(CompetitionController.ShowCreateEdit)"
               class="btn btn-primary">Create new</a>&nbsp;
            <a asp-action="@nameof(CompetitionController.ShowImport)" 
               class="btn btn-primary">Import new</a>
        </div>
    </div>
</div>

